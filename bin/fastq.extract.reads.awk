# fastq.extract.reads.awk
# given a fastq file and a list of read ids in another fileRef file, provides a fastq file that only includes those reads

# example

# inputs
# fileRef
# J00173:77:HNCJHBBXX:6:1101:10003:11266
# J00173:77:HNCJHBBXX:6:1101:10003:13130
# 11601214 (1 fields)

# standard input
# @J00173:77:HNCJHBBXX:6:1101:4107:1543 1:N:0:TGACCA
# CTCTGAGCCAAGCACCTGTCGCAGCCGAGGTGCTGGGGAGGCGGTCCCTGTTGTTTTCCTGGCTTCCTGTTCAGCATCGCTAAAGTACTTGAGATTCGGTAGTTGAGTCCGAAGGCTCC
# +
# <-AFJJFFFJAFAF77FJFJJFJA<<-AJ<JJJ-AFJJ<AJ<7A--7<FJAFJAAJF77FA<AFAJFJJAFFFJ7JJFFFJAFAFJJFJJF-7<-F<A-AFJFAF<AFAAJF-J-F-<A
# @J00173:77:HNCJHBBXX:6:1101:5365:1543 1:N:0:TGACCA
# GTTGTGAGGATGAAATGAAATGCAGCTTTAAAGTGTTTGGTTTTATAATAGGTGCTCAATAAAATGTC
# +
# A-<<-FJJ<JAAAJJ<7JJJAAAJJJFFFJAJJJFAJF-<AA-AFFFJJJ<-<-7AF<FJJFJJJFJ<
# @J00173:77:HNCJHBBXX:6:1101:6705:1543 1:N:0:TGACCA
# TAATTATTATATTCCCAAGCTTACTATTCCCAACACCCAAACGACTCATTAATAACCGCACAATCTCGATCCAACAATG

# output
# @J00173:77:HNCJHBBXX:6:1101:4107:1543 1:N:0:TGACCA
# CTCTGAGCCAAGCACCTGTCGCAGCCGAGGTGCTGGGGAGGCGGTCCCTGTTGTTTTCCTGGCTTCCTGTTCAGCATCGCTAAAGTACTTGAGATTCGGTAGTTGAGTCCGAAGGCTCC
# +
# <-AFJJFFFJAFAF77FJFJJFJA<<-AJ<JJJ-AFJJ<AJ<7A--7<FJAFJAAJF77FA<AFAJFJJAFFFJ7JJFFFJAFAFJJFJJF-7<-F<A-AFJFAF<AFAAJF-J-F-<A
# @J00173:77:HNCJHBBXX:6:1101:5365:1543 1:N:0:TGACCA
# GTTGTGAGGATGAAATGAAATGCAGCTTTAAAGTGTTTGGTTTTATAATAGGTGCTCAATAAAATGTC
# +
# A-<<-FJJ<JAAAJJ<7JJJAAAJJJFFFJAJJJFAJF-<AA-AFFFJJJ<-<-7AF<FJJFJJJFJ<
# @J00173:77:HNCJHBBXX:6:1101:6705:1543 1:N:0:TGACCA
# TAATTATTATATTCCCAAGCTTACTATTCCCAACACCCAAACGACTCATTAATAACCGCACAATCTCGATCCAACAATG

BEGIN{
    while (getline < fileRef >0)
    {
	ok["@"$1]=1;
    }
}

NR%4==1&&ok[$1]==1{
    print;
    okline[NR+1]=1;
    okline[NR+2]=1;
    okline[NR+3]=1;
}

NR%4!=1&&okline[NR]==1{
    print;
}

